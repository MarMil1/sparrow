<% if current_user.roles.first.name == 'admin' && current_user != user %>
    <div class="dropdown <%=dropdown_position%>">
        <button class="btn btn-sm btn-<%= user_role_color(user) %> btn-ghost">
            <%= render "shared/user_role_tag", user: user %>
            <%= heroicon "chevron-down" %>
        </button>
        <ul tabindex="0" class="dropdown-content menu bg-base-100 rounded-box z-[1] w-52 p-2 shadow">
            <% User.available_roles.each do |role| %>
                <li>
                    <%= form_with(model: user, url: user_path(user), method: :patch, class: "inline") do |f| %>
                        <%= f.hidden_field :role, value: role %>
                        <button type="submit" class="cursor-pointer w-full text-left">
                            <div class="flex justify-between items-center">
                                <span><%= role.capitalize %></span>
                                <% if user.has_role?(role) %>
                                    <%= heroicon "check", options: { class: "w-4 h-4 text-success" } %>
                                <% end %>
                            </div>
                        </button>
                    <% end %>
                </li>
            <% end %>
        </ul>
    </div>
<% else %>
    <%= render "shared/user_role_tag", user: user %>
<% end %>