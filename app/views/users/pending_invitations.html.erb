<h1 class="text-xl font-bold mb-6">User management</h1>

<div class="mb-12 mt-6 overflow-x-auto">
  <div class="flex sm:flex-row flex-col md:items-center items-start justify-between p-4">
    <%= render "user_selection_menu" %>
    <%= render "shared/invite_user_btn" %>
  </div>
    <div class="border rounded-xl"> 
      <table class="table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Role</th>
            <th>Invitation Sent At</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <% if @pending_users.count > 0 %>
            <% @pending_users.each do |user| %>
              <% unique_id = SecureRandom.hex(6) %>
              <tr>
                <th scope="row" class="whitespace-nowrap">
                  <a href="<%= user_path(user) %>" class="flex w-min">
                      <%= render "shared/user_blob", user: user %>
                  </a>
                </th>

                <td>
                  <%= render "shared/user_role_tag", user: user %>
                </td>

                <td class="whitespace-nowrap opacity-50">
                  <%= user.invitation_sent_at.strftime("%B %d, %Y %H:%M") %>
                </td>

                <td>
                  <% if user.invitation_accepted? %>
                        <div class="badge badge-success p-3 gap-2 mt-1">
                            <%= heroicon "check" %> Accepted
                        </div>
                    <% else %>
                        <div class="flex gap-2 items-center mt-1 whitespace-nowrap"> 
                            <div class="badge badge-warning p-3 gap-2">
                                <%= heroicon "exclamation-triangle" %> Not accepted
                            </div>
                            <div>
                                <%= button_to 'Resend invitation', resend_invitation_user_path(user), method: :patch, class: "link link-primary no-underline font-medium" %>
                            </div>
                        </div>
                    <% end %>
                </td>
              </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>
    
      <% if @pending_users.count == 0 %>
        <p class="text-gray-500 m-8 text-center text-sm">No pending invitations found.</p>
      <% end %>
    </div>
</div>